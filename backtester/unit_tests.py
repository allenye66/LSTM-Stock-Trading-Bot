import unittest
from connect_db import *
from simulation import * 

class TestConnectDB(unittest.TestCase):
	
	def test_add_zero(self):
		self.assertEqual(add_zero('2'), '02')
		self.assertEqual(add_zero('02'), '02')

	def test_generate_dates(self):
		start_1 = "2019-12-02"
		start_2 = "2019-12-1"
		start_3 = "2019-08-11"
		start_4 = "2019-8-11"

		end_1 = "2019-12-02"
		end_2 = "2019-12-30"
		end_3 = "2019-08-22"
		end_4 = "2019-8-22"

		self.assertEqual(generate_dates(start_1, end_1), ["2019-12-02"]) 
		self.assertEqual(generate_dates(start_2, end_1), generate_dates(start_1, end_1))
		self.assertEqual(generate_dates(start_1, end_2), ['2019-12-02', '2019-12-03', '2019-12-04', '2019-12-05', '2019-12-06', '2019-12-09', '2019-12-10', '2019-12-11', '2019-12-12', '2019-12-13', '2019-12-16', '2019-12-17', '2019-12-18', '2019-12-19', '2019-12-20', '2019-12-23', '2019-12-24', '2019-12-25', '2019-12-26', '2019-12-27', '2019-12-30'])
		self.assertEqual(generate_dates(start_2, end_2), generate_dates(start_1, end_2))
		self.assertEqual(generate_dates(start_3, end_3), generate_dates(start_4, end_4) )
		self.assertEqual(generate_dates(start_3, end_3), ['2019-08-12', '2019-08-13', '2019-08-14', '2019-08-15', '2019-08-16', '2019-08-19', '2019-08-20', '2019-08-21', '2019-08-22'])

	def testRetrieveData(self):
		table = "GOOGL_DATA"
		date_1 = '2019-11-13'
		date_1_to_date_1_data = [1293.18, 1293.7, 1293.79, 1294.71, 1295.43, 1296.02, 1296.49, 1297.69, 1297.63, 1297.11, 1297.5, 1297.03, 1296.62, 1296.32, 1296.0, 1295.69, 1296.03, 1296.16, 1295.65, 1295.89, 1295.17, 1294.12, 1295.11, 1295.36, 1295.09, 1294.82, 1295.65, 1295.07, 1295.56, 1295.33, 1295.65, 1295.51, 1296.36, 1296.79, 1297.0, 1297.41, 1297.17, 1296.44, 1296.96, 1297.18, 1298.24, 1297.32, 1297.84, 1298.49, 1298.58, 1298.87, 1298.83, 1299.37, 1299.25, 1299.45, 1300.01, 1300.6, 1300.04, 1301.0, 1300.98, 1301.65, 1301.25, 1301.1, 1300.7, 1301.39, 1301.33, 1301.32, 1302.32, 1302.09, 1300.0, 1300.0, 1299.55, 1299.27, 1299.54, 1300.48, 1301.11, 1300.56, 1300.22, 1300.23, 1300.42, 1300.6, 1301.0, 1301.43, 1301.0, 1300.43, 1299.8, 1299.76, 1299.51, 1299.72, 1300.07, 1300.07, 1300.07, 1300.1, 1300.0, 1299.86, 1300.02, 1299.89, 1299.2, 1299.49, 1298.81, 1299.18, 1298.63, 1298.61, 1299.26, 1299.21, 1298.81, 1297.88, 1297.02, 1297.52, 1297.22, 1297.42, 1298.57, 1298.54, 1298.61, 1297.35, 1297.75, 1298.9, 1298.36, 1297.68, 1297.81, 1297.81, 1297.81, 1297.48, 1297.41, 1296.66, 1296.15, 1296.98, 1297.23, 1297.45, 1297.53, 1297.51, 1297.8, 1298.21, 1298.04, 1298.34, 1298.79, 1298.08, 1298.08, 1298.45, 1299.34, 1299.69, 1299.22, 1299.16, 1299.12, 1299.92, 1300.1, 1300.7, 1301.13, 1300.92, 1301.11, 1301.53, 1300.74, 1301.22, 1300.6, 1300.84, 1300.88, 1300.15, 1300.86, 1300.46, 1299.71, 1299.67, 1299.77, 1299.51, 1299.19, 1299.11, 1299.23, 1298.02, 1298.36, 1299.02, 1299.4, 1299.85, 1299.66, 1299.91, 1299.37, 1299.21, 1299.51, 1299.67, 1299.27, 1299.27, 1299.38, 1299.2, 1298.99, 1299.59, 1299.69, 1299.53, 1298.75, 1299.22, 1299.22, 1299.36, 1299.76, 1299.66, 1299.98, 1300.39, 1300.12, 1300.12, 1300.56, 1300.45, 1300.94, 1301.05, 1301.09, 1300.11, 1300.08, 1300.25, 1300.45, 1300.31, 1300.91, 1300.81, 1300.55, 1300.26, 1300.96, 1300.51, 1300.99, 1300.75, 1300.74, 1300.76, 1300.93, 1300.93, 1300.57, 1300.26, 1300.96, 1300.73, 1300.62, 1300.85, 1301.27, 1301.1, 1301.18, 1301.18, 1301.41, 1301.34, 1301.34, 1301.49, 1301.36, 1301.34, 1301.22, 1301.13, 1301.44, 1301.26, 1300.43, 1300.36, 1300.52, 1300.74, 1300.38, 1300.17, 1300.38, 1300.38, 1300.26, 1300.55, 1300.77, 1300.9, 1301.34, 1301.0, 1300.72, 1300.67, 1300.72, 1300.46, 1300.36, 1300.65, 1300.21, 1300.08, 1300.0, 1300.22, 1300.13, 1300.09, 1300.06, 1300.42, 1300.3, 1299.77, 1299.76, 1299.09, 1299.33, 1299.53, 1299.32, 1298.59, 1295.93, 1294.82, 1295.25, 1294.36, 1293.93, 1294.69, 1296.0, 1296.05, 1296.05, 1295.48, 1295.66, 1295.23, 1295.43, 1294.37, 1294.94, 1294.47, 1294.51, 1294.65, 1294.14, 1294.54, 1294.61, 1294.61, 1294.47, 1294.53, 1294.53, 1294.34, 1294.16, 1293.89, 1293.77, 1294.34, 1293.86, 1294.21, 1293.74, 1294.01, 1294.74, 1294.09, 1293.88, 1293.85, 1293.87, 1293.98, 1293.85, 1293.85, 1294.18, 1294.2, 1295.24, 1295.25, 1295.29, 1295.44, 1295.33, 1295.46, 1295.76, 1296.21, 1296.2, 1296.71, 1296.67, 1296.77, 1296.67, 1296.46, 1296.64, 1297.11, 1297.12, 1297.15, 1297.88, 1297.99, 1297.58, 1297.72, 1298.23, 1298.29, 1298.38, 1298.45, 1298.16, 1298.14, 1297.95, 1297.77, 1297.55, 1297.56, 1297.52, 1297.58, 1297.65, 1297.5, 1297.49, 1297.01, 1297.48, 1297.38, 1297.41, 1297.43, 1297.63, 1297.62, 1297.28, 1297.43, 1297.56, 1297.57, 1297.25, 1297.55, 1297.05, 1297.33, 1297.4, 1298.27, 1298.33, 1297.58, 1297.71, 1297.49, 1297.18, 1297.05, 1297.27, 1297.32, 1297.44, 1297.24, 1297.15, 1297.27, 1297.22, 1296.8, 1296.2, 1294.69, 1295.09, 1295.39, 1295.52, 1296.87, 1296.34, 1297.36, 1296.42, 1296.64]
		date_2 = '2019-11-19'

		#dates between date_3 to date_4 are only business days
		date_3 = "2019-11-18"
		date_4 = "2019-11-22"
		date_3_to_date_4_data = [1332.34, 1333.25, 1333.55, 1330.56, 1328.7, 1327.98, 1327.13, 1327.59, 1324.56, 1324.31, 1322.04, 1322.24, 1321.07, 1320.35, 1318.83, 1318.5, 1319.7, 1320.18, 1320.77, 1322.51, 1322.08, 1322.74, 1322.64, 1322.97, 1323.1, 1321.69, 1321.77, 1322.42, 1322.34, 1323.05, 1322.6, 1323.22, 1324.39, 1323.52, 1323.73, 1324.03, 1323.48, 1323.38, 1322.6, 1322.79, 1321.97, 1322.22, 1322.8, 1323.29, 1322.7, 1321.41, 1320.97, 1320.1, 1319.86, 1319.67, 1319.5, 1320.29, 1320.3, 1320.34, 1320.21, 1320.26, 1320.07, 1320.43, 1321.38, 1320.25, 1320.1, 1320.25, 1321.69, 1320.72, 1320.97, 1321.35, 1321.02, 1321.58, 1321.48, 1320.1, 1321.47, 1321.89, 1322.34, 1322.18, 1322.1, 1323.12, 1322.38, 1322.4, 1321.41, 1321.95, 1322.74, 1323.27, 1322.84, 1323.34, 1323.08, 1321.96, 1321.52, 1321.25, 1321.58, 1320.89, 1320.31, 1320.63, 1320.25, 1321.31, 1320.58, 1319.54, 1319.4, 1319.86, 1318.64, 1318.85, 1318.77, 1319.98, 1321.21, 1321.0, 1320.22, 1318.56, 1318.94, 1318.93, 1318.62, 1318.36, 1318.92, 1319.95, 1320.99, 1321.25, 1321.82, 1321.94, 1323.3, 1323.98, 1324.58, 1324.83, 1324.55, 1324.92, 1324.54, 1324.9, 1324.55, 1325.65, 1325.62, 1325.11, 1324.9, 1325.48, 1325.65, 1326.14, 1325.39, 1324.85, 1323.84, 1323.26, 1322.96, 1323.79, 1324.33, 1324.08, 1324.5, 1324.6, 1324.18, 1323.37, 1324.16, 1324.9, 1324.63, 1323.39, 1323.58, 1323.18, 1322.88, 1322.42, 1322.04, 1322.4, 1322.59, 1322.28, 1321.55, 1322.17, 1322.77, 1322.49, 1322.44, 1322.21, 1322.14, 1322.01, 1321.81, 1322.03, 1321.71, 1321.11, 1321.25, 1321.0, 1321.32, 1321.21, 1321.44, 1321.56, 1321.05, 1320.75, 1320.12, 1319.74, 1319.77, 1318.75, 1318.97, 1319.04, 1319.44, 1319.59, 1320.07, 1320.24, 1320.03, 1319.43, 1319.71, 1318.94, 1319.02, 1319.54, 1319.54, 1318.95, 1319.33, 1318.8, 1319.08, 1318.85, 1319.21, 1319.59, 1319.59, 1319.47, 1319.47, 1319.12, 1319.34, 1319.34, 1319.32, 1319.28, 1319.0, 1319.25, 1319.16, 1318.78, 1318.56, 1318.55, 1319.23, 1319.75, 1319.91, 1319.83, 1320.01, 1319.71, 1319.67, 1319.86, 1319.86, 1319.62, 1319.66, 1319.79, 1319.94, 1320.03, 1320.22, 1320.02, 1319.71, 1319.71, 1319.44, 1319.74, 1319.9, 1319.84, 1319.83, 1319.73, 1319.69, 1319.54, 1319.59, 1319.76, 1319.93, 1319.92, 1319.72, 1319.99, 1320.3, 1320.42, 1320.27, 1319.79, 1319.82, 1319.82, 1320.26, 1321.0, 1320.82, 1321.02, 1320.56, 1320.56, 1321.07, 1321.44, 1321.13, 1321.08, 1321.38, 1321.38, 1321.38, 1321.5, 1321.39, 1321.24, 1320.81, 1320.52, 1320.42, 1320.86, 1320.56, 1320.86, 1321.18, 1321.04, 1321.53, 1321.71, 1321.62, 1321.37, 1321.79, 1321.42, 1321.68, 1321.44, 1321.51, 1321.3, 1321.61, 1321.4, 1321.25, 1321.54, 1321.78, 1321.51, 1321.84, 1322.89, 1323.07, 1323.05, 1323.28, 1322.74, 1323.03, 1322.94, 1323.44, 1323.25, 1323.46, 1323.21, 1323.25, 1323.26, 1323.37, 1323.32, 1322.99, 1323.39, 1323.69, 1323.95, 1324.45, 1324.52, 1324.49, 1324.52, 1324.76, 1324.4, 1324.7, 1323.78, 1323.47, 1323.64, 1323.58, 1323.39, 1323.65, 1323.25, 1323.89, 1323.38, 1323.5, 1323.45, 1323.89, 1323.72, 1323.46, 1322.48, 1322.92, 1322.85, 1323.26, 1323.42, 1323.59, 1323.49, 1323.57, 1323.26, 1323.17, 1323.27, 1323.27, 1322.78, 1321.81, 1321.78, 1321.27, 1321.14, 1321.54, 1321.82, 1322.06, 1322.02, 1321.91, 1321.85, 1321.98, 1321.94, 1321.94, 1321.54, 1321.77, 1321.06, 1321.27, 1320.77, 1321.0, 1321.06, 1320.42, 1320.96, 1320.92, 1321.5, 1321.52, 1321.65, 1321.05, 1320.0, 1320.2, 1319.64, 1318.84, 1319.1, 1319.01, 1319.05, 1316.87, 1317.27, 1316.55, 1317.05, 1317.4, 1317.84, 1317.16, 1316.79, 1317.9, 1317.65, 1326.63, 1324.86, 1324.26, 1321.68, 1320.67, 1319.08, 1318.7, 1319.84, 1320.15, 1320.98, 1321.96, 1321.66, 1320.66, 1320.33, 1320.0, 1319.24, 1319.29, 1319.39, 1319.88, 1319.58, 1319.67, 1319.56, 1318.8, 1319.13, 1318.26, 1319.15, 1318.85, 1318.84, 1318.68, 1318.03, 1317.41, 1317.25, 1318.07, 1317.19, 1316.77, 1316.76, 1316.46, 1316.0, 1314.03, 1314.43, 1314.98, 1315.15, 1316.52, 1316.7, 1316.86, 1316.25, 1315.45, 1316.37, 1315.74, 1315.94, 1316.2, 1315.5, 1315.98, 1315.55, 1315.73, 1316.96, 1317.31, 1317.96, 1318.44, 1318.44, 1318.5, 1317.27, 1318.56, 1319.28, 1319.28, 1319.22, 1318.78, 1318.76, 1318.73, 1318.67, 1318.93, 1319.2, 1318.8, 1318.86, 1318.43, 1318.33, 1317.84, 1317.7, 1315.83, 1316.23, 1316.17, 1315.66, 1315.16, 1314.74, 1314.62, 1314.15, 1314.04, 1313.61, 1313.75, 1314.55, 1314.63, 1315.14, 1316.1, 1316.09, 1315.81, 1316.74, 1317.36, 1317.81, 1317.33, 1316.61, 1317.11, 1316.65, 1315.99, 1315.58, 1316.44, 1316.47, 1316.3, 1316.76, 1317.32, 1316.9, 1316.82, 1317.0, 1316.62, 1316.1, 1316.76, 1316.02, 1316.07, 1316.73, 1317.08, 1317.3, 1316.87, 1317.0, 1316.87, 1317.48, 1316.17, 1316.07, 1315.93, 1315.65, 1316.56, 1318.65, 1318.48, 1318.38, 1318.27, 1317.99, 1317.64, 1317.54, 1316.62, 1316.78, 1317.12, 1317.45, 1317.48, 1317.58, 1317.31, 1317.15, 1316.9, 1316.81, 1317.22, 1317.38, 1318.06, 1318.0, 1318.28, 1318.18, 1318.22, 1318.09, 1317.77, 1317.13, 1316.88, 1316.82, 1316.8, 1316.35, 1316.35, 1316.52, 1316.33, 1316.03, 1316.48, 1316.53, 1316.33, 1316.16, 1317.16, 1317.51, 1317.74, 1317.48, 1318.02, 1317.75, 1317.23, 1316.98, 1316.63, 1316.4, 1316.26, 1316.56, 1316.61, 1316.13, 1315.75, 1315.87, 1315.56, 1315.7, 1315.49, 1315.81, 1315.83, 1315.83, 1316.09, 1315.69, 1316.01, 1315.75, 1315.56, 1315.76, 1315.97, 1316.63, 1316.95, 1317.29, 1317.07, 1317.07, 1317.08, 1316.82, 1316.1, 1316.12, 1316.07, 1315.86, 1315.73, 1316.12, 1316.52, 1316.08, 1315.61, 1315.26, 1315.39, 1315.33, 1315.03, 1315.0, 1315.1, 1314.9, 1315.42, 1314.92, 1315.01, 1315.14, 1315.11, 1314.92, 1314.92, 1315.42, 1315.12, 1315.52, 1315.35, 1315.75, 1315.43, 1315.32, 1315.24, 1315.4, 1315.56, 1315.49, 1315.34, 1315.19, 1314.87, 1314.12, 1313.94, 1314.22, 1314.06, 1314.54, 1314.48, 1314.55, 1314.04, 1314.09, 1314.92, 1314.88, 1314.86, 1314.55, 1314.98, 1314.99, 1314.47, 1314.44, 1313.89, 1314.04, 1313.98, 1314.13, 1314.41, 1314.26, 1314.06, 1313.98, 1313.85, 1314.03, 1314.16, 1313.83, 1313.31, 1313.67, 1313.49, 1313.46, 1313.68, 1313.7, 1313.48, 1313.72, 1314.34, 1314.63, 1314.84, 1314.59, 1314.42, 1314.3, 1314.3, 1314.62, 1314.62, 1314.59, 1314.54, 1314.61, 1314.61, 1314.7, 1315.15, 1315.56, 1315.07, 1314.84, 1314.98, 1314.77, 1314.84, 1314.01, 1313.5, 1313.64, 1313.75, 1313.64, 1313.84, 1313.19, 1313.18, 1312.86, 1313.26, 1313.18, 1313.06, 1313.16, 1313.1, 1312.73, 1313.2, 1313.29, 1313.59, 1313.78, 1313.42, 1313.33, 1313.77, 1313.47, 1313.15, 1313.0, 1312.64, 1313.26, 1313.11, 1312.85, 1312.46, 1312.39, 1312.43, 1312.21, 1311.95, 1311.77, 1312.23, 1312.18, 1313.25, 1313.44, 1314.14, 1313.76, 1313.84, 1314.09, 1314.02, 1314.36, 1314.25, 1313.97, 1314.02, 1313.52, 1313.76, 1313.77, 1313.8, 1313.43, 1313.25, 1313.08, 1312.8, 1313.08, 1313.05, 1312.77, 1312.79, 1312.62, 1312.92, 1313.38, 1313.82, 1313.78, 1313.73, 1314.17, 1314.8, 1314.45, 1315.53, 1315.32, 1315.4, 1315.5, 1315.85, 1315.56, 1315.45, 1315.05, 1314.72, 1314.82, 1314.59, 1314.09, 1314.65, 1315.6, 1314.48, 1314.53, 1314.87, 1314.02, 1313.52, 1312.34, 1312.77, 1312.47, 1311.49, 1310.4, 1308.54, 1307.04, 1305.6, 1304.79, 1304.61, 1304.0, 1303.7, 1304.48, 1305.2, 1305.85, 1306.51, 1306.6, 1304.22, 1303.29, 1303.63, 1304.52, 1305.49, 1305.58, 1304.96, 1305.3, 1305.36, 1305.32, 1304.62, 1304.58, 1305.47, 1304.85, 1305.41, 1305.1, 1304.87, 1306.63, 1307.43, 1307.44, 1307.39, 1307.19, 1306.69, 1306.6, 1308.26, 1308.76, 1307.24, 1307.69, 1307.05, 1307.42, 1307.34, 1307.12, 1307.29, 1307.18, 1307.58, 1308.15, 1307.86, 1308.01, 1306.82, 1306.46, 1307.59, 1306.68, 1307.56, 1308.68, 1307.75, 1307.08, 1306.57, 1307.05, 1307.25, 1307.81, 1307.34, 1308.35, 1308.72, 1309.55, 1308.98, 1309.17, 1308.97, 1309.06, 1308.61, 1308.61, 1308.49, 1307.5, 1307.52, 1308.82, 1308.68, 1308.99, 1309.13, 1310.0, 1309.33, 1309.87, 1309.5, 1309.88, 1309.7, 1309.13, 1309.33, 1309.15, 1309.37, 1309.72, 1309.77, 1309.14, 1309.12, 1309.75, 1309.57, 1308.92, 1308.5, 1308.95, 1307.65, 1307.93, 1307.72, 1307.7, 1308.15, 1308.33, 1308.61, 1308.55, 1308.97, 1308.44, 1307.92, 1308.09, 1307.68, 1308.13, 1307.97, 1308.42, 1308.09, 1307.93, 1307.85, 1307.14, 1306.63, 1306.27, 1305.68, 1305.36, 1305.6, 1305.79, 1306.59, 1306.87, 1307.02, 1307.5, 1307.28, 1306.08, 1305.91, 1305.62, 1306.03, 1305.56, 1305.12, 1305.64, 1305.78, 1305.79, 1305.45, 1305.89, 1305.68, 1305.81, 1305.75, 1305.72, 1305.92, 1306.09, 1306.14, 1305.61, 1305.87, 1306.11, 1305.4, 1304.77, 1305.37, 1305.19, 1305.65, 1305.61, 1305.79, 1305.93, 1306.38, 1306.38, 1306.38, 1306.61, 1306.51, 1305.79, 1305.43, 1306.31, 1306.38, 1306.33, 1306.9, 1306.0, 1305.75, 1306.15, 1306.27, 1305.93, 1306.43, 1306.18, 1306.19, 1306.07, 1305.88, 1305.74, 1305.88, 1305.65, 1305.64, 1306.03, 1306.4, 1306.92, 1306.85, 1306.55, 1306.31, 1306.51, 1306.24, 1306.2, 1306.36, 1306.05, 1305.97, 1305.78, 1305.84, 1305.48, 1305.67, 1305.89, 1305.33, 1304.19, 1304.53, 1304.45, 1303.95, 1302.47, 1301.38, 1299.84, 1301.98, 1301.15, 1300.43, 1300.5, 1299.75, 1299.13, 1298.78, 1298.35, 1296.86, 1296.31, 1294.98, 1291.53, 1291.31, 1292.32, 1292.27, 1292.45, 1292.01, 1291.1, 1291.09, 1292.17, 1290.94, 1292.74, 1293.57, 1294.33, 1294.9, 1293.87, 1294.22, 1295.06, 1295.9, 1293.56, 1292.61, 1291.21, 1289.72, 1290.45, 1291.53, 1292.03, 1292.29, 1292.16, 1293.09, 1292.56, 1291.93, 1291.83, 1293.08, 1293.47, 1292.41, 1291.67, 1293.83, 1294.06, 1291.9, 1291.67, 1291.97, 1292.78, 1292.53, 1293.4, 1294.66, 1294.71, 1293.74, 1294.14, 1293.34, 1293.53, 1294.01, 1293.77, 1293.6, 1293.06, 1293.66, 1293.2, 1293.02, 1293.03, 1291.97, 1292.86, 1293.63, 1294.15, 1294.75, 1294.57, 1294.85, 1293.22, 1293.85, 1292.77, 1292.95, 1292.58, 1293.22, 1293.91, 1293.7, 1293.92, 1293.76, 1294.57, 1296.26, 1295.94, 1295.88, 1296.48, 1295.85, 1296.24, 1296.91, 1296.95, 1296.56, 1296.76, 1297.15, 1297.22, 1297.61, 1297.58, 1297.75, 1298.07, 1298.13, 1297.44, 1297.92, 1298.0, 1297.47, 1296.46, 1295.55, 1296.54, 1296.39, 1296.37, 1296.5, 1296.76, 1296.8, 1296.2, 1296.03, 1295.79, 1296.15, 1295.53, 1295.96, 1296.0, 1295.86, 1295.23, 1295.76, 1296.19, 1296.71, 1297.0, 1297.3, 1297.22, 1298.48, 1298.4, 1298.21, 1298.1, 1298.66, 1298.25, 1298.41, 1297.84, 1297.77, 1297.72, 1296.26, 1295.85, 1295.77, 1296.47, 1296.97, 1296.9, 1297.07, 1296.63, 1296.88, 1296.5, 1296.72, 1296.12, 1295.87, 1295.98, 1296.4, 1296.3, 1296.4, 1296.65, 1296.78, 1296.79, 1297.28, 1297.44, 1297.84, 1297.81, 1298.45, 1298.71, 1299.19, 1299.72, 1300.1, 1300.05, 1299.33, 1300.0, 1299.75, 1299.83, 1299.95, 1301.35, 1301.38, 1300.91, 1300.37, 1300.32, 1300.25, 1299.94, 1298.89, 1298.07, 1296.98, 1297.14, 1296.73, 1295.02, 1295.81, 1295.25, 1295.0, 1292.43, 1292.8, 1293.68, 1292.67, 1292.47, 1294.22, 1295.77, 1294.25, 1293.42, 1293.24, 1294.0, 1294.74, 1294.36, 1294.89, 1293.91, 1294.23, 1294.82, 1293.82, 1292.9, 1291.64, 1291.51, 1291.79, 1293.95, 1293.68, 1292.92, 1294.6, 1295.66, 1296.94, 1296.48, 1296.97, 1297.42, 1297.78, 1297.24, 1297.49, 1296.34, 1295.83, 1292.4, 1293.83, 1293.77, 1293.97, 1294.69, 1296.44, 1296.33, 1295.58, 1294.72, 1294.97, 1294.9, 1295.88, 1295.38, 1294.65, 1294.21, 1293.71, 1293.76, 1294.22, 1294.0, 1294.58, 1294.67, 1294.48, 1295.35, 1295.51, 1295.64, 1295.77, 1295.63, 1295.6, 1295.6, 1295.08, 1294.93, 1295.92, 1295.32, 1295.4, 1294.44, 1294.3, 1294.05, 1293.7, 1293.61, 1294.06, 1294.98, 1295.62, 1296.0, 1296.3, 1296.2, 1296.39, 1296.84, 1297.8, 1296.79, 1297.05, 1296.93, 1297.11, 1296.96, 1296.71, 1295.92, 1296.05, 1295.94, 1295.13, 1294.6, 1295.4, 1295.53, 1295.14, 1294.73, 1294.48, 1294.05, 1294.25, 1293.65, 1293.99, 1293.94, 1294.73, 1294.36, 1294.37, 1295.03, 1295.09, 1294.61, 1295.06, 1295.62, 1296.24, 1295.34, 1295.05, 1295.06, 1294.96, 1293.94, 1294.39, 1294.41, 1293.8, 1293.55, 1294.0, 1295.31, 1296.07, 1296.42, 1296.26, 1296.01, 1295.67, 1295.44, 1294.39, 1294.68, 1294.54, 1294.56, 1294.78, 1295.11, 1294.65, 1294.3, 1293.55, 1293.56, 1293.93, 1294.98, 1294.72, 1295.77, 1295.33, 1295.18, 1295.05, 1295.08, 1294.92, 1294.64, 1294.44, 1294.84, 1294.76, 1294.36, 1294.57, 1294.25, 1294.79, 1294.13, 1294.13, 1294.11, 1294.49, 1295.16, 1296.24, 1296.36, 1296.73, 1297.0, 1297.58, 1297.18, 1296.96, 1297.44, 1297.25, 1297.23, 1297.75, 1297.92, 1297.42, 1297.65, 1297.1, 1297.25, 1297.24, 1297.64, 1297.33, 1297.36, 1297.5, 1297.76, 1297.71, 1297.62, 1297.41, 1296.72, 1296.71, 1297.33, 1297.34, 1297.28, 1297.27, 1297.21, 1297.21, 1297.09, 1297.43, 1297.94, 1297.84, 1298.8, 1299.31, 1299.26, 1299.31, 1298.47, 1298.2, 1298.8, 1298.95, 1299.35, 1299.18, 1299.83, 1299.39, 1299.26, 1299.21, 1299.25, 1299.33, 1299.96, 1300.35, 1300.0, 1300.0, 1300.27, 1300.58, 1300.36, 1300.58, 1300.7, 1300.48, 1300.7, 1301.0, 1301.23, 1301.51, 1301.22, 1300.65, 1300.47, 1300.68, 1300.0, 1299.97, 1299.78, 1299.78, 1300.09, 1300.45, 1300.34, 1300.19, 1300.26, 1300.4, 1300.51, 1300.84, 1301.08, 1301.0, 1300.8, 1301.07, 1300.92, 1301.06, 1300.95, 1300.98, 1300.75, 1300.77, 1300.16, 1300.1, 1300.3, 1300.12, 1300.76, 1300.87, 1300.58, 1300.6, 1300.21, 1300.68, 1301.28, 1301.99, 1302.51, 1302.36, 1302.92, 1303.0, 1303.24, 1303.5, 1303.49, 1304.79, 1304.61, 1304.32, 1304.08, 1304.54, 1304.65, 1305.19, 1305.31, 1305.37, 1305.59, 1305.51, 1305.53, 1305.87, 1306.24, 1307.3, 1307.77, 1307.97, 1308.92, 1308.8, 1310.0, 1310.42, 1310.77, 1309.56, 1310.04, 1309.95, 1310.94, 1310.88, 1310.14, 1309.2, 1308.12, 1308.14, 1308.21, 1308.05, 1307.42, 1307.51, 1306.96, 1307.03, 1307.39, 1308.05, 1306.98, 1306.84, 1306.89, 1307.61, 1307.27, 1307.36, 1306.6, 1306.66, 1306.77, 1305.53, 1305.52, 1305.02, 1305.07, 1305.22, 1304.69, 1304.67, 1304.76, 1304.72, 1304.87, 1304.72, 1304.17, 1303.65, 1303.73, 1303.25, 1303.29, 1303.08, 1303.11, 1303.08, 1302.59, 1302.62, 1302.82, 1303.26, 1303.5, 1303.4, 1303.26, 1303.3, 1303.35, 1303.18, 1302.45, 1302.41, 1301.83, 1301.68, 1301.23, 1300.99, 1300.7, 1300.23, 1299.67, 1301.01, 1300.56, 1301.33, 1301.4, 1301.28, 1300.97, 1301.33, 1300.52, 1300.63, 1298.07, 1297.3, 1297.84, 1297.39, 1297.69, 1299.26, 1299.76, 1299.81, 1299.76, 1304.3, 1301.9, 1300.98, 1300.27, 1301.36, 1303.42, 1305.79, 1305.49, 1306.16, 1306.49, 1304.97, 1303.64, 1303.79, 1303.73, 1304.34, 1304.96, 1304.78, 1304.48, 1305.0, 1304.78, 1304.43, 1304.09, 1303.83, 1304.7, 1304.98, 1302.85, 1302.95, 1301.55, 1302.81, 1303.9, 1304.02, 1304.47, 1302.92, 1303.39, 1303.0, 1303.19, 1302.74, 1302.5, 1301.92, 1301.13, 1301.69, 1301.37, 1300.99, 1300.33, 1300.08, 1299.91, 1300.69, 1301.24, 1299.95, 1299.44, 1299.18, 1299.66, 1300.02, 1299.91, 1298.77, 1298.25, 1298.07, 1298.99, 1298.6, 1297.1, 1295.64, 1295.19, 1295.65, 1295.0, 1294.69, 1294.13, 1293.04, 1293.91, 1293.77, 1293.45, 1293.24, 1294.72, 1294.65, 1294.9, 1295.26, 1295.23, 1295.43, 1294.78, 1294.09, 1294.86, 1294.76, 1294.74, 1294.58, 1295.29, 1293.11, 1293.18, 1293.53, 1294.15, 1295.48, 1295.46, 1296.6, 1297.24, 1297.17, 1295.47, 1294.45, 1293.51, 1293.44, 1293.3, 1293.88, 1294.77, 1295.92, 1294.78, 1294.78, 1295.0, 1294.52, 1294.87, 1295.06, 1294.99, 1294.73, 1294.98, 1294.78, 1295.41, 1295.96, 1296.97, 1296.63, 1296.67, 1296.62, 1296.62, 1296.99, 1296.93, 1297.32, 1297.23, 1296.91, 1296.25, 1295.42, 1295.99, 1296.52, 1296.11, 1296.5, 1295.56, 1295.8, 1295.47, 1296.27, 1296.51, 1296.17, 1296.26, 1296.47, 1297.25, 1296.99, 1296.99, 1297.02, 1296.6, 1296.11, 1295.76, 1295.63, 1296.16, 1296.16, 1295.98, 1296.11, 1295.24, 1295.62, 1295.39, 1295.56, 1296.08, 1296.56, 1296.24, 1295.99, 1295.89, 1296.44, 1296.15, 1297.11, 1297.77, 1297.88, 1297.49, 1297.49, 1297.16, 1297.6, 1297.28, 1297.57, 1297.84, 1299.08, 1300.01, 1300.29, 1300.75, 1300.53, 1300.43, 1299.91, 1299.88, 1299.55, 1299.55, 1299.55, 1298.69, 1299.06, 1298.88, 1298.84, 1298.53, 1298.27, 1298.46, 1298.06, 1298.24, 1298.33, 1297.88, 1299.11, 1299.35, 1298.9, 1298.55, 1298.75, 1299.49, 1299.76, 1299.63, 1299.42, 1299.69, 1299.3, 1299.52, 1299.46, 1299.99, 1299.64, 1299.32, 1298.87, 1298.49, 1298.49, 1298.27, 1298.24, 1298.25, 1298.31, 1298.57, 1298.75, 1298.53, 1298.37, 1298.43, 1298.57, 1298.53, 1298.39, 1298.37, 1298.19, 1298.21, 1298.21, 1298.2, 1298.31, 1297.98, 1297.68, 1297.25, 1297.3, 1296.67, 1296.57, 1296.21, 1296.36, 1296.33, 1296.65, 1296.42, 1296.27, 1296.21, 1296.05, 1296.24, 1295.52, 1296.13, 1296.24, 1296.09, 1295.73, 1295.59, 1295.42, 1295.54, 1295.43, 1295.62, 1296.01, 1295.93, 1295.83, 1295.85, 1295.71, 1295.63, 1294.8, 1294.38, 1294.92, 1295.02, 1295.11, 1294.86, 1295.08, 1295.02, 1295.3, 1295.12, 1295.04, 1294.8, 1293.95, 1294.12, 1294.17, 1294.17, 1294.26, 1294.26, 1294.32, 1294.13, 1293.86, 1293.79, 1293.83, 1293.5, 1293.77, 1293.72, 1293.66, 1293.7, 1293.8, 1293.66, 1293.5, 1293.53, 1293.69, 1293.47, 1293.46, 1293.68, 1293.56, 1293.61, 1293.25, 1292.74, 1292.74, 1292.73, 1292.79, 1292.74, 1292.96, 1293.09, 1293.23, 1293.18, 1292.88, 1293.0, 1293.16, 1292.55, 1292.35, 1292.15, 1292.47, 1291.97, 1291.81, 1292.0, 1292.16, 1292.75, 1292.3, 1292.01, 1292.83, 1292.23, 1292.33, 1292.67, 1292.3, 1291.89, 1291.71, 1291.84, 1291.78, 1291.68, 1291.46, 1291.61, 1291.73, 1291.67, 1291.52, 1292.73, 1292.23, 1292.69, 1293.09, 1293.25, 1293.7, 1293.18, 1293.39, 1293.28, 1293.28, 1293.33, 1293.99, 1294.15, 1293.92, 1294.14, 1293.72, 1293.61, 1293.28, 1293.67, 1293.42, 1293.46, 1294.0, 1293.95, 1293.8, 1294.37, 1293.86, 1293.9, 1293.9, 1293.66, 1294.04, 1294.17, 1293.75, 1293.6, 1293.99, 1293.57, 1293.31, 1292.84, 1293.35, 1293.25, 1292.45, 1293.2, 1292.62, 1292.4, 1291.12, 1289.56, 1290.27, 1289.72, 1290.19, 1291.64, 1291.89, 1292.32, 1292.48, 1292.3]
		
		self.assertEqual(type(retrieve_data(table, date_1, date_1)), dict)
		self.assertEqual(type(retrieve_data(table, date_1, date_1)['dates']), list)
		self.assertEqual(type(retrieve_data(table, date_1, date_1)['prices']), list)
		self.assertEqual(len(retrieve_data(table, date_1, date_1)['prices']), 390)
		self.assertEqual(retrieve_data(table, date_1, date_1)['prices'], date_1_to_date_1_data)
		self.assertEqual(len(retrieve_data(table, date_3, date_4)['prices']), 390 * len(generate_dates(date_3, date_4)))
		self.assertEqual(retrieve_data(table, date_3, date_4)['prices'], date_3_to_date_4_data)
		self.assertEqual(sorted(list(set([x[:10] for x in retrieve_data(table, date_3, date_4)['dates']]))), generate_dates(date_3, date_4))



	def testSimulation(self):

		date_1 = "2019-11-18"
		date_2 = "2019-11-22"
		table = "GOOGL_DATA"
		data_1 = retrieve_data(table, date_1, date_1)
		money_1 = 1000000
		money_2 = 1
		threshold = 0.587
		features = 250
		self.assertEqual(simulate({"dates":data_1['dates'], "prices": data_1['prices']}, money_1, threshold, features)['profit'], -1135.03)
		self.assertEqual(int(simulate({"dates":data_1['dates'], "prices": data_1['prices']}, money_2, threshold, features)['profit']), 0)

		
if __name__ == '__main__':
	unittest.main()